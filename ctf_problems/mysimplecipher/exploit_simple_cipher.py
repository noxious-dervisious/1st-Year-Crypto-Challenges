from __future__ import print_function
def exploit(ciphertext):
	i = 0
	key_length = 13
	flag_len = len(ciphertext) - key_length - 2
	flag = ['']*flag_len
	key = ['']*13
	message =flag + ['|'] + key
	j = 21
	for i in range (key_length):
		key[j % 13 ] = chr((ord(ciphertext[j+1]) - ord(message[j]) - ord(ciphertext[j])) % 128)
		message[flag_len + 1 + j%13] = key[j%13]
		j = flag_len + 1 + j%13
	key = "".join(key)
	for alpha in range (len(message)-1):
		message[alpha] = chr((ord(ciphertext[alpha+1]) - ord(key[alpha % key_length]) - ord(ciphertext[alpha])) % 128)
	message = "".join(message)
	print("Message : ",message)
	print("Keys : ",key)
	print("Flag : ",message[:21])

def main():
	file = open('output.txt').read().strip()
	ciphertext = file.decode('hex')
	exploit(ciphertext)

main()