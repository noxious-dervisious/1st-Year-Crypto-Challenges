# The GiantXOR Challenge from InCTF

The main gist of the problem lies in simple repeating key XOR but with a bit of complexity by adding an extra level of encryption involving base64 encoding just before encrypting it with a random key generated by the program and then again hex encoding the ciphertext obtained. Even if we decode the hex we won’t be able to perform any sort of basic frequency analysis techniques to break this XOR as the result obtained after hex decoding is a ciphertext itself consisting of a base64 string encoded with a random key.
This fact completely discards the idea of frequency analysis to obtain the key or key length.
There comes a new concept of Index of Coincidence (IC) which in a mathematical terminology is the probability of getting to randomly selected characters equal where we will be using this technique to obtain the key size and there by obtaining the key using simple bruteforce.

**How do I get the Index of Coincidence?** Is the question now  let’s suppose we have a text of size N wherein we have n type of characters for finding out what is the index of coincidence we first need to calculate the independent probability of finding each character for that we can use a simple maths concept of permutation and combination along with probability.

![pic1](https://github.com/noxious-dervisious/Begineer-s-Challenge/blob/master/CTF%20Challenges/GiantXOR/Images/ICpic1.jpg)
					
Now we need to just add up all the obtained probabilities of all the n characters to obtain our IC 

![pic2](https://github.com/noxious-dervisious/Begineer-s-Challenge/blob/master/CTF%20Challenges/GiantXOR/Images/ICpic2.jpg)
			 	

**Now what to do with the IC?** Now that we know what is IC we can proceed further to obtain the key length for that we have  to follow a few basic steps at first we have to divide the whole ciphertext into blocks of probable key lengths and find their respective ICs and compare them and select the one with the highest IC value as our key length. We further know that each of these divided blocks are encrypted by the same key.Now the most interesting part where we need to bruteforce the ciphertext to obtain the main key.   

**Now again one more question on how to do that ?** As by now we know that our key length (i.e 12 for the given challenge) we first need to divide the whole ciphertext in blocks according to our key length and then bruteforce a single byte XOR but the problem here is that we won’t get a plaintext in english in turn we will obtain a base64 encoded strings part i.e only a segment of the base64 encoded string  so our aim is to check whether the obtained segment can be base64 decoded or not if yes then proceed with that character as a character in the key.Similarly from every block we will obtain a character of the key which all together forms the main key which can be used to obtain the plaintext. For doing so we need to apply a basic repeated key XOR function.

